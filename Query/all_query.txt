-- Active: 1727179020532@@127.0.0.1@5432@ems@public

--USERS:

CREATE TABLE users (
    id SERIAL PRIMARY KEY,
    username VARCHAR(50) NOT NULL,
    email VARCHAR(100) NOT NULL,
    password VARCHAR(128) NOT NULL,
    role VARCHAR(20) NOT NULL
);



--EVENTS: 

CREATE TABLE events (
    id SERIAL PRIMARY KEY,
    created_by INT NOT NULL,
    status VARCHAR(10) NOT NULL CHECK (Status IN ('Approved', 'Pending', 'Rejected', 'Modified')),
    current_approver INT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);



--EVENT APPROVAL:

CREATE TABLE eventapprovals (
    id SERIAL PRIMARY KEY,
    event_id INT NOT NULL,
    created_by INT NOT NULL,
    status VARCHAR(10) NOT NULL CHECK (Status IN ('Approved', 'Pending', 'Rejected', 'Modified')),
    current_approver INT NOT NULL,
    reason TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (event_id) REFERENCES events(id) ON DELETE CASCADE
);



--Notification: 

CREATE TABLE notifications (
    id SERIAL PRIMARY KEY,
    user_id INT NOT NULL,
    event_id INT NOT NULL,
    notification_type VARCHAR(20) NOT NULL CHECK (notification_type IN ('Approval_required', 'Reminder')),
    message TEXT NOT NULL,
    sent_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
    FOREIGN KEY (event_id) REFERENCES events(id) ON DELETE CASCADE
);

--REPORT :

CREATE TABLE report (
  id SERIAL PRIMARY KEY,
  event_id INT NOT NULL,  -- Foreign key linking to the events table
  title VARCHAR(255),
  event_type VARCHAR(100),
  guest_speakers JSONB,  -- Stores guest speakers as JSON
  start_date DATE,
  start_time TIME,
  end_date DATE,
  end_time TIME,
  objectives TEXT[],  -- Array to store multiple objectives
  venue VARCHAR(255),
  resources TEXT,
  audience INT,
  description TEXT,
  photos TEXT[],  -- Assuming you are storing paths or URLs for photos
  faculty_coordinators JSONB,  -- Stores faculty coordinators as JSON
  student_coordinators JSONB,  -- Stores student coordinators as JSON
  schools TEXT[],  -- Array to store multiple schools
  branches TEXT[],  -- Array to store multiple branches
  classes TEXT[],  -- Array to store multiple classes
  years TEXT[],  -- Array to store years (e.g. 1st Year)
  clubs TEXT,
  
  CONSTRAINT fk_event
      FOREIGN KEY (event_id) 
      REFERENCES events(id)  -- References the id column in the events table
      ON DELETE CASCADE      -- Optionally: Delete the report if the event is deleted
);


CREATE TABLE event_details (
    id SERIAL PRIMARY KEY,
    event_id INTEGER NOT NULL,
    event_dates JSONB NOT NULL,
    school_audience JSONB NOT NULL,
    audience INTEGER NOT NULL,
    clubs TEXT[] NOT NULL,
    resources TEXT,
    created_at TIMESTAMP WITHOUT TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP WITHOUT TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    eventtype TEXT[] NOT NULL,
    objectives TEXT[] NOT NULL,
    title TEXT NOT NULL,
    description TEXT NOT NULL,
    guests JSONB,
    otherclub VARCHAR,
    otherevent VARCHAR
);



--CLUBS: 

-- App Development Club
CREATE TABLE app_development_club (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    role VARCHAR(255) NOT NULL
);
-- Insert Faculty Coordinator
INSERT INTO app_development_club (name, role)
VALUES ('Dhiraj Bhise', 'Faculty Coordinator');

-- Insert Core Members
INSERT INTO app_development_club (name, role)
VALUES 
('Meet Maheshwari', 'Core Member'),
('Owais Bubere', 'Core Member'),
('Yashasvee Wankhede', 'Core Member'),
('Rushikesh Patil', 'Core Member'),
('Malay Padshah', 'Core Member'),
('Rehan Singhal', 'Core Member'),
('Sakina Kayyawala', 'Core Member'),
('Aastha Tiwari', 'Core Member'),
('Navya Singh', 'Core Member'),
('Jenish Mehta', 'Core Member'),
('Ronak Vishanvani', 'Core Member');



-- Atrangi Club
CREATE TABLE atrangi_club (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    role VARCHAR(255) NOT NULL
);
-- Insert Faculty In-Charge 
INSERT INTO atrangi_club (name, role) VALUES 
('Prof. Sonia Relan', 'Faculty Coordinator');

INSERT INTO atrangi_club (name, role) VALUES
('Mahek Gopani', 'Member'),
('Dhruv Singh', 'Member'),
('Priyanshi Sinha', 'Member');







-- Coding Club
CREATE TABLE coding_club (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    role VARCHAR(255) NOT NULL
);

INSERT INTO coding_club (name, role) VALUES
('Dr. Suraj Patil', 'Faculty In-charge'),
('Prof. Praveen Landge', 'Faculty In-charge'),
('Mahek Gopani', 'Core Committee Member'),
('Dhruv Singh', 'Core Committee Member'),
('Priyanshi Sinha', 'Core Committee Member');



-- Competitive Preparation
CREATE TABLE competitive_preparation (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    role VARCHAR(255) NOT NULL
);

INSERT INTO competitive_preparation (name, role) VALUES
('Dr. Amit Pandit', 'Faculty In-charge'),
('Uday Patil', 'Core Committee Member');



-- CRS.ILC
CREATE TABLE crs_ilc (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    role VARCHAR(255) NOT NULL
);

INSERT INTO crs_ilc (name, role) VALUES
('Dr. Sankha Bhattacharya', 'Faculty In-charge'),
('Sarthak Khamitkar', 'Core Committee Member'),
('Khushi Gupta', 'Core Committee Member'),
('Harsh Tiwari', 'Core Committee Member'),
('Rupesh More', 'Core Committee Member'),
('Sourav Chaudhari', 'Core Committee Member'),
('Janhvi Borkar', 'Core Committee Member'),
('Aditi Samdani', 'Core Committee Member'),
('Atharva Kurkute', 'Core Committee Member'),
('Sarbani Roy', 'Core Committee Member'),
('Abhiram Patil', 'Core Committee Member'),
('Shivika Gupta', 'Core Committee Member'),
('Bhushan Mahajan', 'Core Committee Member'),
('Tanvi Maheshwari', 'Core Committee Member'),
('Rutuja More', 'Core Committee Member'),
('Rahul Anand', 'Core Committee Member');



-- Computer Society of India (CSI)
CREATE TABLE computer_society_of_india (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    role VARCHAR(255) NOT NULL
);

INSERT INTO computer_society_of_india (name, role) VALUES
('Dr. Mayank Sohani', 'Faculty In-charge'),
('Prof. Piyush Kumar Soni', 'Faculty In-charge'),
('Gargi Jain', 'Core Committee Member - IV/B Tech/CS'),
('Meet Maheshwari', 'Core Committee Member - III/MBA Tech/CE'),
('Vansh Julka', 'Core Committee Member - IV/B Tech/AIML'),
('Ashish Neelkanth', 'Core Committee Member - IV/B Tech/IT'),
('Abhishek Pal', 'Core Committee Member - III/B Tech/CS'),
('Owais Burbere', 'Core Committee Member - III/MBA Tech/CE'),
('Vishwa Bhalodiya', 'Core Committee Member - IV/B Tech/CS');



-- Cultural Activity Forum
CREATE TABLE cultural_activity_forum (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    role VARCHAR(255) NOT NULL
);

INSERT INTO cultural_activity_forum (name, role) VALUES
('Dr. Mahendra Prajapati', 'Faculty In-charge'),
('Dr. Amit Pandit', 'Member'),
('Dr. Anitha Kuttiapyan', 'Member'),
('Durvaa Desai', 'Core Committee Member - Bpharma+MBA (3rd Year)'),
('Shrushti Samdadiya', 'Core Committee Member - Bpharma+MBA (3rd Year)'),
('Krisha Shah', 'Core Committee Member - Bpharma (4th Year)');



-- EOSO
CREATE TABLE eoso (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    role VARCHAR(255) NOT NULL
);

INSERT INTO eoso (name, role) VALUES
('Dr. Payal Dande', 'Faculty In-charge'),
('Mahi Sahu', 'Core Committee Member'),
('Swaraj Borkar', 'Core Committee Member'),
('Varsha Kumari', 'Core Committee Member'),
('Hanusha Sharma', 'Core Committee Member'),
('Amrutha Pillai', 'Core Committee Member'),
('Mita Tamhankar', 'Core Committee Member'),
('Avneesh Taneja', 'Core Committee Member'),
('Harsh Jain', 'Core Committee Member'),
('Yuvraj Alandikar', 'Core Committee Member'),
('Sanhita Sahane', 'Core Committee Member'),
('Yash Shah', 'Core Committee Member');



-- IEEE
CREATE TABLE ieee (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    role VARCHAR(255) NOT NULL
);

INSERT INTO ieee (name, role) VALUES
('Prof. Atul Patil', 'Faculty In-charge'),
('Prof. Rehan Ahmed', 'Faculty In-charge'),
('Yomesh Khandalwal', 'Core Committee Member'),
('Amay Thakkar', 'Core Committee Member');



-- ISTE
CREATE TABLE iste (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    role VARCHAR(255) NOT NULL
);

INSERT INTO iste (name, role) VALUES
('Dr. Suresh Kurumbanshi', 'Faculty In-charge');



-- Learn Tech
CREATE TABLE learn_tech (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    role VARCHAR(255) NOT NULL
);

INSERT INTO learn_tech (name, role) VALUES
('Prof. Dhananjay Joshi', 'Faculty In-charge'),
('Rasanath Kulkarni', 'Core Committee Member'),
('Anjali Agrawal', 'Core Committee Member'),
('Dhananjay Khairnar', 'Core Committee Member'),
('Abhisek Pal', 'Core Committee Member'),
('Dhyani Shah', 'Core Committee Member'),
('Utkarsh Mandloi', 'Core Committee Member'),
('Syed Farhanuddin', 'Core Committee Member');



-- NMMUN
CREATE TABLE nmmun (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    role VARCHAR(255) NOT NULL
);

INSERT INTO nmmun (name, role) VALUES
('Dr. Rakesh Chaudhari', 'Faculty In-charge'),
('Owais Fahim Bubere', 'Director General'),
('Nishtha Desai', 'Chief Relation Officer'),
('Meet Maheshwari', 'Head Charge D’ Affairs'),
('Nitya Chourasia', 'Deputy Director General'),
('Aastha Tiwari', 'Deputy Director General'),
('Vrudhi Varma', 'Deputy Secretary General'),
('Aditya Patil', 'Deputy Secretary General'),
('Rushikesh Patil', 'Planning and Strategy Head'),
('Avneesh Taneja', 'Planning and Strategy Head'),
('Rasanath Kulkarni', 'Planning and Strategy Head');



-- S4DS
CREATE TABLE s4ds (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    role VARCHAR(255) NOT NULL
);

INSERT INTO s4ds (name, role) VALUES
('Prof. Rajesh Verma', 'Faculty In-charge');



-- Soft Skill Club
CREATE TABLE soft_skill_club (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    role VARCHAR(255) NOT NULL
);

INSERT INTO soft_skills_club (name, role) VALUES
('SINOY SUGUNAN', 'Faculty In-charge'),
('Ms. KHUSHI RATHI', 'Core Committee Member'),
('Mr. DARSHILKUMAR PATEL', 'Core Committee Member'),
('Ms. DIPLAXMI RANE', 'Core Committee Member'),
('Ms. APURVA MASULE', 'Core Committee Member'),
('Mr. HARSHAL PATIL', 'Core Committee Member');



-- Team UAS
CREATE TABLE team_uas_nmims (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    role VARCHAR(255) NOT NULL
);

INSERT INTO team_uas_nmims (name, role) VALUES
('Prof. Sachin Chavan', 'Faculty In-charge'),
('Prof. Mayank Kothari', 'Faculty In-charge'),
('Vaibhav Tayal', 'Captain'),
('Om Biscuitwala', 'Vice-Captain'),
('Parth Sharma', 'Core Committee Member'),
('Vismay Kansara', 'Core Committee Member'),
('Shrinivas Ahirrao', 'Core Committee Member'),
('Yomesh Khandelwal', 'Core Committee Member');



-- The Writers Hub
CREATE TABLE the_writers_hub (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    role VARCHAR(255) NOT NULL
);

INSERT INTO the_writers_hub (name, role) VALUES
('Dr. Preeti C. Sangave', 'Faculty In-charge'),
('Dr. Sanjay Shrivastava', 'Faculty In-charge'),
('Ms. Mahi Sahu', 'Core Committee Member'),
('Ms. Hanusha Sharma', 'Core Committee Member'),
('Ms. Aastha Gawali', 'Core Committee Member'),
('Ms. Durvaa Desai', 'Core Committee Member'),
('Mr. Rasnath Kulkarni', 'Core Committee Member'),
('Mr. Avneesh Kumar Taneja', 'Core Committee Member'),
('Ms. Mita Tamhankar', 'Core Committee Member'),
('Mr. Ritvik Kharde', 'Core Committee Member'),
('Mr. Adishwar Jain', 'Core Committee Member'),
('Ms. Riya Vengurlekar', 'Core Committee Member');



--drop all tables
DROP TABLE users, events, eventapprovals, notifications, report, event_details, app_development_club, atrangi_club, coding_club, competitive_preparation, crs_ilc, computer_society_of_india, cultural_activity_forum, eoso, ieee, iste, learn_tech, nmmun, s4ds, soft_skill_club, team_uas, the_writers_hub;



-- Create the table with a password column before role
CREATE TABLE ClubInfo (
    id SERIAL PRIMARY KEY,
    username VARCHAR(255),
    email VARCHAR(100),
    password VARCHAR(100),
    role VARCHAR(50)
);

-- Insert the data with the password for all entries
INSERT INTO users (username, email, password, role)
VALUES 
('INSTITUTIONS INNOVATION COUNCIL (IIC)', 'iic_mptp.shirpur@nmims.edu', '$2a$10$4qTzgZdVtr7NnecdCPBu9.zbm.wMCpJ5eSq5Z3OF4wABFygzYiMEa', 'faculty'),
('IPR CELL', NULL, '$2a$10$4qTzgZdVtr7NnecdCPBu9.zbm.wMCpJ5eSq5Z3OF4wABFygzYiMEa', 'faculty'),
('E-CELL', NULL, '$2a$10$4qTzgZdVtr7NnecdCPBu9.zbm.wMCpJ5eSq5Z3OF4wABFygzYiMEa', 'faculty'),
('INSTITUTE–INDUSTRY INTERACTION AND INTERNSHIP CELL (I4C)', NULL, '$2a$10$4qTzgZdVtr7NnecdCPBu9.zbm.wMCpJ5eSq5Z3OF4wABFygzYiMEa', 'faculty'),
('NATIONAL INNOVATION AND START-UP POLICY (NISP) CELL', NULL, '$2a$10$4qTzgZdVtr7NnecdCPBu9.zbm.wMCpJ5eSq5Z3OF4wABFygzYiMEa', 'faculty'),
('Saturday 10 am', 'saturday10am@nmims.edu', '$2a$10$4qTzgZdVtr7NnecdCPBu9.zbm.wMCpJ5eSq5Z3OF4wABFygzYiMEa', 'faculty'),
('EACH ONE SAVE ONE', 'socialforumshirpur@nmims.edu', '$2a$10$4qTzgZdVtr7NnecdCPBu9.zbm.wMCpJ5eSq5Z3OF4wABFygzYiMEa', 'faculty'),
('The Writers Hub', 'thewritershub.shirpur@nmims.edu', '$2a$10$4qTzgZdVtr7NnecdCPBu9.zbm.wMCpJ5eSq5Z3OF4wABFygzYiMEa', 'faculty'),
('RAW VISION CLUB', 'RAWVISION_MPTP.shirpur@nmims.edu', '$2a$10$4qTzgZdVtr7NnecdCPBu9.zbm.wMCpJ5eSq5Z3OF4wABFygzYiMEa', 'faculty'),
('ATRANGI CLUB', NULL, '$2a$10$4qTzgZdVtr7NnecdCPBu9.zbm.wMCpJ5eSq5Z3OF4wABFygzYiMEa', 'faculty'),
('Computer Society of India (CSI)', 'CSI_MPSTME.shirpur@nmims.edu', '$2a$10$4qTzgZdVtr7NnecdCPBu9.zbm.wMCpJ5eSq5Z3OF4wABFygzYiMEa', 'faculty'),
('NMMUN (Narsee Monjee Model United Nation)', 'Nmmun_mptp.shirpur@nmims.edu', '$2a$10$4qTzgZdVtr7NnecdCPBu9.zbm.wMCpJ5eSq5Z3OF4wABFygzYiMEa', 'faculty'),
('Coding Club', 'CODINGCLUB_MPSTME.shirpur@nmims.edu', '$2a$10$4qTzgZdVtr7NnecdCPBu9.zbm.wMCpJ5eSq5Z3OF4wABFygzYiMEa', 'faculty'),
('App Development Club', 'APPDEVCLUB_MPSTME.shirpur@nmims.edu', '$2a$10$4qTzgZdVtr7NnecdCPBu9.zbm.wMCpJ5eSq5Z3OF4wABFygzYiMEa', 'faculty'),
('Google Developer''s Club', 'Gdsc_mpstme.shirpur@nmims.edu', '$2a$10$4qTzgZdVtr7NnecdCPBu9.zbm.wMCpJ5eSq5Z3OF4wABFygzYiMEa', 'faculty'),
('TEAM UAS NMIMS (Drone Club)', 'DRONECLUB_MPSTME.shirpur@nmims.edu', '$2a$10$4qTzgZdVtr7NnecdCPBu9.zbm.wMCpJ5eSq5Z3OF4wABFygzYiMEa', 'faculty'),
('ISTE', 'ISTE_MPSTME.shirpur@nmims.edu', '$2a$10$4qTzgZdVtr7NnecdCPBu9.zbm.wMCpJ5eSq5Z3OF4wABFygzYiMEa', 'faculty'),
('IEEE', 'IEEE_MPSTME.shirpur@nmims.edu', '$2a$10$4qTzgZdVtr7NnecdCPBu9.zbm.wMCpJ5eSq5Z3OF4wABFygzYiMEa', 'faculty'),
('Society 4DS', 'SOCIETY4Ds_MPSTME.shirpur@nmims.edu', '$2a$10$4qTzgZdVtr7NnecdCPBu9.zbm.wMCpJ5eSq5Z3OF4wABFygzYiMEa', 'faculty'),
('AVINYA - IOT LAB', NULL, '$2a$10$4qTzgZdVtr7NnecdCPBu9.zbm.wMCpJ5eSq5Z3OF4wABFygzYiMEa', 'faculty'),
('Learn Tech with NMIMS Shirpur', 'LEARNTECH_MPSTME.shirpur@nmims.edu', '$2a$10$4qTzgZdVtr7NnecdCPBu9.zbm.wMCpJ5eSq5Z3OF4wABFygzYiMEa', 'faculty'),
('FLAVIUM', 'FLAVIUM_MPSTME.shirpur@nmims.edu', '$2a$10$4qTzgZdVtr7NnecdCPBu9.zbm.wMCpJ5eSq5Z3OF4wABFygzYiMEa', 'faculty'),
('AMBIORA - Technical Event', 'AMBIORA_MPSTME.shirpur@nmims.edu', '$2a$10$4qTzgZdVtr7NnecdCPBu9.zbm.wMCpJ5eSq5Z3OF4wABFygzYiMEa', 'faculty'),
('PROTSAHAN', 'PROTSAHAN_MPSTME.shirpur@nmims.edu', '$2a$10$4qTzgZdVtr7NnecdCPBu9.zbm.wMCpJ5eSq5Z3OF4wABFygzYiMEa', 'faculty');


-- Alter the table to change the size of username to varchar(100)
ALTER TABLE users
ALTER COLUMN username TYPE VARCHAR(100);


ALTER TABLE users
ALTER COLUMN email DROP NOT NULL;